post:
  summary: Setup appliance
  description: >
    Initialize a freshly installed appliance to create the master tenant and
    System Admin user. 

    Authorization is not required. 

    This operation can only be executed successfully once.
  operationId: setup
  tags:
    - Setup
  security: []
  requestBody:
    content:
      application/json:
        schema:
          type: object
          required:
            - applianceName
            - accountName
            - username
            - email
            - password
          properties:
            applianceName:
              type: string
              description: >-
                Appliance Name. Choose a name for your Morpheus Appliance.  This
                is stored in the Appliance Settings.
            applianceUrl:
              type: string
              description: >-
                Appliance URL. Specify the full URL for your Morpheus Appliance.
                This is stored in the Appliance Settings.
            accountName:
              type: string
              description: Name of the Master Tenant account being created.
            firstName:
              type: string
              description: First Name for the System Admin user being created.
            lastName:
              type: string
              description: Last Name for the System Admin user being created.
            username:
              type: string
              description: Username for the System Admin user being created.
            email:
              type: string
              description: Email for the System Admin user being created.
            password:
              type: string
              format: password
              description: Password for the System Admin user being created.
            hubmode:
              description: >-
                Hub Mode. Determines if and how the appliance should connect
                with the Morpheus Hub. The default value (skip) means do not
                connect with the hub, and you will be installing your license
                manually. If you login or register with the hub then a Community
                Edition license will be installed automatically.
              type: string
              enum:
                - skip
                - register
                - login
              default: skip
            hub:
              schema:
                oneOf:
                  - $ref: ../components/schemas/hubLoginObject.yaml
                  - $ref: ../components/schemas/hubRegisterObject.yaml
                discriminator:
                  propertyName: hubmode
                  mapping:
                    login: ../components/schemas/hubLoginObject.yaml
                    register: ../components/schemas/hubRegisterObject.yaml
        examples:
          setup:
            $ref: ../components/examples/setup.yaml
          setupWithHubRegistration:
            $ref: ../components/examples/hubRegisterObject.yaml
          setupWithHubLogin:
            $ref: ../components/examples/hubLoginObject.yaml
  responses:
    '200':
      description: >-
        Appliance setup complete. The master tenant and system admin user were
        created successfully.
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
              buildVersion:
                type: string
                description: Morpheus build version that the server is running.
              applianceUrl:
                type: string
                description: The Appliance Server URL as defined under Appliance Settings.
              setupNeeded:
                type: boolean
                description: >-
                  Flag to determine if the appliance has been setup, only true
                  when appliance is a fresh install and has not been
                  initialized.
              hub:
                type: object
                description: >-
                  Settings for connecting to the [Morpheus
                  Hub](https://morpheushub.com)
                properties:
                  enabled:
                    type: boolean
                    description: Flag to determine if hub connectivity is enabled.
                  url:
                    type: string
                    description: The [Morpheus Hub](https://morpheushub.com) URL.
                    default: https://morpheushub.com
            example:
              success: true
              buildVersion: 5.4.4
              applianceUrl: https://matrix.morpheusdata.com/
              environment: production
              setupNeeded: false
    '400':
      description: Appliance has already been setup
      content:
        application/json:
          schema:
            allOf:
              - $ref: ..\components\schemas\Error.yaml
              - example:
                  success: false
                  msg: Appliance has already been setup
    '401':
      description: Unauthorized.
    '403':
      description: Forbidden.
    '404':
      description: Object Not Found.
    '500':
      description: Internal Server Error.
    '503':
      description: Service Unavailable.
